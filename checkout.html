<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="favicon.png">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

  <!-- Bootstrap CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link href="css/tiny-slider.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <title>IKEAM</title>
</head>

<body>

  <!-- Start Header/Navigation -->
  <nav class="custom-navbar navbar navbar-expand-md navbar navbar-dark bg-dark" aria-label="Furni navigation bar">

    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="images/ikeam.png" height="100" width="200">
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsFurni">
        <ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
          <li class="nav-item ">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li><a class="nav-link" href="shop.html">Shop</a></li>
          <li><a class="nav-link" href="about.html">About us</a></li>
          <li><a class="nav-link" href="services.html">Services</a></li>
          <li><a class="nav-link" href="blog.html">Blog</a></li>
          <li><a class="nav-link" href="contact.html">Contact us</a></li>
        </ul>

        <ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
          <li><a class="nav-link" href="#"><img src="images/user.svg"></a></li>
          <li><a class="nav-link" href="cart.html"><img src="images/cart.svg"></a></li>
        </ul>
      </div>
    </div>

  </nav>
  <!-- End Header/Navigation -->

  <!-- Start Hero Section -->
  <div class="hero">
    <div class="container">
      <div class="row justify-content-between">
        <div class="col-lg-5">
          <div class="intro-excerpt">
            <h1>Checkout</h1>
          </div>
        </div>
        <div class="col-lg-7">

        </div>
      </div>
    </div>
  </div>
  <!-- End Hero Section -->

  <div class="untree_co-section">
    <div class="container">
      <div class="row mb-5">
        <div class="col-md-12">
          <div class="border p-4 rounded" role="alert">
            j'ai encore un doute? <a href="cart.html">Cliquez ici</a> pour modifier .
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-5 mb-md-0">
          <h2 class="h3 mb-3 text-black">Billing Details</h2>
          <div class="p-3 p-lg-5 border bg-white">

			<!-- START FORM BILLING DETAILS -->

			<form id="billing-details-form" action="php/send_invoice.php" method="post">
				<div class="form-group">
                <label for="country" class="text-black">Country <span class="text-danger">*</span></label>
                <select id="country" class="form-control" required>
                  <option value="1" disabled>Select a country</option>
                  <option value="2">Morocco</option>
                  <option value="3">Algeria</option>
                  <option value="4">Tunisia</option>
                  <option value="5">Turkey</option>
                  <option value="6">Egypt</option>
                </select>
              </div>
              <div class="form-group row">
                <div class="col-md-6">
                  <label for="fname"  class="text-black">First Name <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="fname" name="fname" required>
                </div>
                <div class="col-md-6">
                  <label for="lname" class="text-black">Last Name <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="lname" name="lname" required>
                </div>
              </div>
              <div class="form-group">
                <label for="companyname" class="text-black">Company Name</label>
                <input type="text" class="form-control" id="companyname" name="companyname">
              </div>
              <div class="form-group">
                <label for="address" class="text-black">Address <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="address" name="address" required>
              </div>
              <div class="form-group">
                <label for="optionaladdress" class="text-black">Apartment, suite, unit etc. (optional)</label>
                <input type="text" class="form-control" id="optionaladdress" name="optionaladdress">
              </div>
              <div class="form-group row">
                <div class="col-md-6">
                  <label for="statecountry" class="text-black">City <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="statecountry" name="statecountry" required>
                </div>
                <div class="col-md-6">
                  <label for="postalzip" class="text-black">Postal / Zip <span class="text-danger">*</span></label>
                  <input type="number" class="form-control" id="postalzip" name="postalzip" required>
                </div>
              </div>
              <div class="form-group">
                <label for="email" class="text-black">Email Address <span class="text-danger">*</span></label>
                <input type="email" class="form-control" id="email" name="email" required>
              </div>
              <div class="form-group">
                <label for="phone" class="text-black">Phone <span class="text-danger">*</span></label>
                <input type="tel" class="form-control" id="phone" name="phone" required>
              </div>
              <div class="form-group">
                <label for="order-notes" class="text-black">Order Notes</label>
                <textarea class="form-control" id="order-notes" name="order-notes" rows="4"></textarea>
              </div>
            
          </div>
        </div>
        <div class="col-md-6">

          <div class="row mb-5">
            <div class="col-md-12">
              <h2 class="h3 mb-3 text-black">Your Order</h2>
              <div class="p-3 p-lg-5 border bg-white">
				<div class="mb-3">
					<p><strong>Order ID:</strong> <span id="order-id"></span></p>
				</div>
                <table class="table site-block-order-table mb-5">
                  <thead>
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Price</th>
                  </thead>
                  <tbody id="order-items">
                    <!-- Order items will be dynamically inserted here -->
                  </tbody>
                </table>
                <p><strong>Total Price:</strong><span id="total-price"></span> dhs</p>

                <div class="border p-3 mb-3">
                  <h3 class="h6 mb-0"><a class="d-block" data-bs-toggle="collapse" href="#collapsebank" role="button" aria-expanded="false" aria-controls="collapsebank">Direct Bank Transfer</a></h3>

                  <div class="collapse" id="collapsebank">
                    <div class="py-2">
                      <p class="mb-0">Effectuez votre paiement directement sur notre compte bancaire. Veuillez utiliser votre numéro de commande comme référence de paiement. Votre commande ne sera expédiée que lorsque les fonds seront crédités sur notre compte..</p>
                    </div>
                  </div>
                </div>

                <div class="border p-3 mb-5">
                  <h3 class="h6 mb-0"><a class="d-block" data-bs-toggle="collapse" href="#collapsepaypal" role="button" aria-expanded="false" aria-controls="collapsepaypal">Paypal</a></h3>

                  <div class="collapse" id="collapsepaypal">
                    <div class="py-2">
                      <p class="mb-0">Make your payment directly into our bank account. Please use your Order ID as the payment reference. Your order won’t be shipped until the funds have cleared in our account.</p>
                    </div>
                  </div>
                </div>

                <div class="form-group">
                  <button class="btn btn-black btn-lg py-3 btn-block" id="place-order-btn" type="submit" >Place Order</button>
                </div>
				</form>
					<!-- END FORM BILLING DETAILS -->
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Start Footer Section -->
  <footer class="footer-section">
    <!-- Your footer section code goes here -->
  </footer>
  <!-- End Footer Section -->

  <!-- JavaScript libraries -->
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/tiny-slider.js"></script>
  <script src="js/custom.js"></script>
  <!-- Script for dynamically displaying order items and placing order -->
  <script>
    // Retrieve cart items from localStorage
    var cartItems = JSON.parse(localStorage.getItem('cart')) || [];
	var orderId = sessionStorage.getItem('order-id');
    // Function to display order items
    function displayOrderItems() {

      var orderItemsContainer = document.getElementById('order-items');
      var orderItemsHTML = '';

      cartItems.forEach(function(item) {
        orderItemsHTML += '<tr>';
        orderItemsHTML += '<td>' + item.name + '</td>';
        orderItemsHTML += '<td>' + item.quantity + '</td>';
        orderItemsHTML += '<td>' + (item.price * item.quantity).toFixed(2) + ' dhs</td>'; // Total price for each item
        orderItemsHTML += '</tr>';
      });



      orderItemsContainer.innerHTML = orderItemsHTML;
	  document.getElementById('order-id').innerText = orderId;
    }

	

	// Function to generate a random Order ID
       function generateRandomOrderId() {
	    return Math.floor(100000 + Math.random() * 900000);
  }

  // Retrieve the Order ID from sessionStorage or generate a new one
         var orderId = sessionStorage.getItem('order-id');
        if (!orderId) {
          orderId = generateRandomOrderId();
           sessionStorage.setItem('order-id', orderId);
          }    

		  // Display the Order ID
           document.getElementById('order-id').textContent = orderId;

	// Save session ID when the page loads
	window.onload = function () {
		if (!orderId) {
		  sessionStorage.setItem('order-id', orderId);
		}
		displayOrderItemsAndOrderId();
	  };
	  

    // Calculate total price
    function calculateTotalPrice() {
      var totalPrice = 0;
      cartItems.forEach(function(item) {
        totalPrice += item.price * item.quantity;
      });
      return totalPrice.toFixed(2);
    }

    // Display order items and total price on page load
    window.onload = function() {
      displayOrderItems();
      document.getElementById('total-price').textContent = calculateTotalPrice();
    };

    // Place order button click event
    document.getElementById('place-order-btn').addEventListener('click', function() {
      // Validate required inputs
      var requiredInputs = document.querySelectorAll('#billing-details-form [required]');
      var isValid = true;

      requiredInputs.forEach(function(input) {
        if (!input.value.trim()) {
          isValid = false;
          input.classList.add('is-invalid');
        } else {
          input.classList.remove('is-invalid');
        }
      });

	  function placeOrder() {
		// Validate form fields
		var firstname = document.getElementById('fname').value;
		var lastname = document.getElementById('lname').value;
		var email = document.getElementById('email').value;
		var address = document.getElementById('address').value;
		
		// Perform form validation here
		
		// If form is valid, proceed with placing the order
		// You can add your logic here to send the billing details to the server
		// For example, you can use AJAX to send the form data to a PHP script
		
		// Example AJAX request
		
		var xhr = new XMLHttpRequest();
		xhr.open('POST', 'process_form.php', true);
		xhr.setRequestHeader('Content-Type', 'application/json');
		xhr.onload = function() {
		  if (xhr.status === 200) {
			// Request was successful
			// You can handle the response here
		  } else {
			// Request failed
			console.error('Form submission failed:', xhr.statusText);
		  }
		};
		xhr.onerror = function() {
		  console.error('Request failed.');
		};
		xhr.send(JSON.stringify({
		  fullname: fullname,
		  email: email,
		  address: address
		}));
		
	  }

      if (isValid) {
        // Generate and display Order ID
		sessionStorage.removeItem('order-id');

		

		window.location.href = 'thankyou.html'; // Change 'thankyou.html' to the URL of your thank you page
      } else {
        alert('Please fill in all required fields.');
      }
    });
  </script>
</body>
</html>
